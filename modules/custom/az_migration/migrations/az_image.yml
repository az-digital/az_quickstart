id: az_image
label: Images
migration_group: az_migration
audit: true
migration_tags:
  - Drupal 7
  - Content
  - Quickstart Content Migration
  - Media

migration_dependencies:
  required:
    - az_user
    - az_files

dependencies:
  enforced:
    module:
      - az_migration
      - az_media

source:
  plugin: d7_file_entity_item
  type: image

process:
  uid:
    -
      plugin: migration_lookup
      migration: az_user
      no_stub: true
      source: uid
    -
      plugin: default_value
      default_value: 0
  bundle:
    - plugin: default_value
      default_value: az_image
  field_media_az_image/alt:
    - plugin: skip_on_empty
      method: process
      source: 'field_file_image_alt_text/0/value'
  field_media_az_image/title:
    - plugin: skip_on_empty
      method: process
      source: 'field_file_image_title_text/0/value'
  field_media_az_image/target_id:
      - plugin: migration_lookup
        migration:
          - az_files
        source: fid
  field_az_caption:
    - plugin: skip_on_empty
      method: process
      source: 'field_uaqs_caption_text/0/value'
    - plugin: sub_process
      source: field_uaqs_caption_text
      process:
        delta: delta
        value: value
        format:
          plugin: default_value
          default_value: plain_text
  field_az_credit:
    - plugin: skip_on_empty
      method: process
      source: 'field_uaqs_image_credit/0/value'
    - plugin: sub_process
      source: field_uaqs_image_credit
      process:
        delta: delta
        value: value
        format:
          plugin: default_value
          default_value: plain_text
  created: timestamp
  changed: timestamp
  status: status

destination:
  plugin: entity:media
